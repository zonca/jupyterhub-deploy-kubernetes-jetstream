hub:
  templateVars: {'announcement_spawn': 'In case of error, please <a href="https://github.com/det-lab/jupyterhub-deploy-kubernetes-jetstream/issues/new">open an issue on Github</a> pasting the entire error message'}
  db:
    type: sqlite-pvc
    pvc:
      accessModes:
        - ReadWriteOnce
      storage: 1Gi
      storageClassName: cinder-csi
  extraConfig:
    timeout.py: |
        c.Spawner.http_timeout = 90
    track_cpu.py: |
        c.Spawner.args = [
              "--ResourceUseDisplay.track_cpu_percent=True",
        ]
#   # run only on master nodes
#   nodeSelector:
#         node-role.kubernetes.io/master: ""
#   tolerations:
#       - key: "node-role.kubernetes.io/master"
#         operator: Exists

# proxy:
#   # run only on master nodes
#   chp:
#       nodeSelector:
#             node-role.kubernetes.io/master: ""
#       tolerations:
#           - key: "node-role.kubernetes.io/master"
#             operator: Exists

singleuser:
  memory:
      guarantee: 12G
      limit: 12G
  cpu:
      guarantee: 3
  profileList:
    - display_name: "Default: 3 CPUs and 6 GB RAM"
      default: True
    - display_name: "Tiny: 1 CPUs and 3 GB RAM"
      kubespawner_override:
        cpu_guarantee: 1
        mem_limit: 6G
        mem_guarantee: 6G
    - display_name: "Full node: 7 CPUs and 25 GB RAM"
      kubespawner_override:
        cpu_guarantee: 7
        mem_limit: 25G
        mem_guarantee: 25G
  storage:
    type: dynamic
    capacity: 10Gi
    dynamic:
      storageClass: cinder-csi
    extraVolumes:
        - name: cvmfs-nfs-volume
          nfs:
            # for Magnum
            # server: 10.254.77.77
            # for Kubespray
            server: 10.233.46.63
            path: /
    extraVolumeMounts:
        - name: cvmfs-nfs-volume
          mountPath: /cvmfs
          readOnly: false
  image:
    name: "zonca/docker-jupyter-cdms-light"
    tag: "2021.03.17"
  defaultUrl: "/lab"
  # default is 300s, sometimes Jetstream volumes are slow to attach
  startTimeout: 600
  lifecycleHooks:
    postStart:
      exec:
        command:
           - "sh"
           - "-c"
           - >
             chmod 700 .ssh;
             chmod g-s .ssh;
             chmod 600 .ssh/*;
             echo $JUPYTERHUB_USER > ~/.username;
             exit 0
